---
title: HighPay Zoom 网络抓取
categories: [网络抓取]
tags: [spider, 法尔梅·邱]
---

> Author: 法尔梅·邱

## 聊一聊网络爬虫
* 需要用户cookie
* 不需要用户cookie

这里给大家介绍下，需要用户登录信息的网络抓取

## 第一步 找到你要抓取的站点的入口

* 目标站点的官方网站
* 目标站点发布的官方APP
* 目标站点的官方微信公众号
 
## 第二步 探索登录表单


* 从访问官网首页到登录表单，是否下发cookie
* 是否需要验证码，验证码与什么有强的关联关系（后面会举实例说明）
* 登录表单提交时，观察提交的参数列表，是否加密（借助fiddler4即可）
* 登录成功后，是否有大于300的重定向（发生重定向后，怎么办？）
* 登录成功返回数据（1、json数据 2、html）

## 第三步 维持cookie
  * 程序从开始抓取一直到登录成功时的cookie收集，合并，更新（这里我使用的是threadLocal来存放）
  * 对于两次下发的cookie，如果出现相同的key，合并规则是什么；
  * 程序在登录成功后，再去抓取其他接口的数据时要带上cookie

## 常用的技巧
*  json字符串转换成java对象（这样的工具类非常多）
*  正则表达式去扣出想要的东西
*  对密码加密的情景分析
*  js加密与java加密通信
*  构造http请求（header，body）
*  对异常情况的处理，比如超时，404,403,405等情景的分析


## 难点问题
* 大量请求同时登录，如果控制并发（目前未使用多线程和NIO相关）
* JS加密，怎样还原加密过程
* 验证码出现的过程，比如密码错3次出现验证码，一直出现验证码，重新建立连接后不需要验证码等情景
* http请求构造时需要带上特定的参数，比如content-type,referer,Accept等

## 关于作者

  法梅尔.邱 码农一枚，志存高远，并为之努力！QQ:344651570 欢迎交流

